\documentclass[a4paper]{article}
\usepackage{verbatim}

\begin{document}
\section{sudo}

First one needs to install the port sudo. Login as root, then

\begin{verbatim}
cd /usr/ports/security/sudo
make
make install clean
\end{verbatim}

Then one can select which group should contain the sudoers

\begin{verbatim}
visudo
\end{verbatim}

Maybe one needs to create that group and add users to it

\begin{verbatim}
pw groupadd group
pw groupmod group -m new_member
\end{verbatim}

\section{portmaster}
Install portmaster
One usefule command is {\tt whereis}.

\begin{verbatim}
cd /usr/ports/ports-mgmt/portmaster
sudo make install clean
\end{verbatim}

Now e.g. vim can be installed like

\begin{verbatim}
cd /usr/ports
sudo portmaster editors/vim
\end{verbatim}

\begin{verbatim}
sudo portmaster devel/subversion
sudo portmaster devel/git
\end{verbatim}

\section{jails}
For virtualbox I inserted a second harddisc after installing freebsd on the first one.
Add the line

\begin{verbatim}
zfs_enable="YES"
\end{verbatim}

to the rc.conf.
Let ada1 be the new disc, now do

\begin{verbatim}
sudo gpart create -s gpt ada1
sudo gpart add -t freebsd-zfs ada1
sudo zpool create tank ada1p1
sudo zfs create -o mountpoint=/jails tank/jails
sudo zfs create -o mountpoint=/jails/public tank/jails/public
sudo zfs create -o mountpoint=/jails/master tank/jails/master
zfs list
\end{verbatim}


We need to compile a kernel for the jail, so start with

\begin{verbatim}
cd /usr/src
sudo make buildworld
\end{verbatim}

This will take forever.
When it's done install the kernel for the master jail:

\begin{verbatim}
sudo make installworld DESTDIR=/jails/master
sudo make distribution DESTDIR=/jails/master
\end{verbatim}

Now start the jail

\begin{verbatim}
sudo jail -c path=/jails/master command=/bin/sh
\end{verbatim}

The reason we don't use ezjail to create and start the basejail is that we want to install stuff in it, but not have the portstree. 
So we will manually map the portstree into this jail and install M2.

\section{Installing ezjail}
Install the port for ezjail

\begin{verbatim}
sudo portmaster sysutils/ezjail
\end{verbatim}

In the file /usr/local/etc/ezjail.conf add the lines

\begin{verbatim}
ezjail_jaildir=/jails
ezjail_jailbase=${ezjail_jaildir}/master
ezjail_use_zfs="YES"
ezjail_jailzfs="tank/root/jails"
\end{verbatim}

Now we can create and start a first experimental jail

\begin{verbatim}
sudo ezjail-admin create -r /jails/first first 127.0.0.37
sudo ezjail-admin onestart first
jls
\end{verbatim}


\section{Macaulay2}
Install Macaulay2

\begin{verbatim}
# inside ~/src
  svn co svn://svn.macaulay2.com/Macaulay2/trunk M2-trunk
  cd M2-trunk/M2
  gmake

  sudo portmaster devel/bison
  sudo portmaster archivers/gtar
  sudo portmaster math/lapack  # sucks in gcc46, gmp, mpfr, ...
  cd /usr/local/bin
  sudo ln -s gfortran46 gfortran
  sudo portmaster textproc/libxml2

\end{verbatim}

problems: (1) libxml2 parser.h.  Fixed by doing two things: adding
CPPFLAGS=-I/usr/local/include/libxml2 to configure line
and by editing /usr/local/include/libxml2/libxml/xmlversion.h to change ICONV
variable to be 0 not 1.

(2) also add CC=gcc46 CXX=g++46 to the configure line, since lapack being
compiled with newer gcc was causing conflicting types for variables.
(alternatively: install g95, and add LDFLAGS=-L/usr/local/lib to configure
line.  This is what I am trying now).

(3) configure script itself needs to be bash, not sh.

(4) needed to first run 'gmake' in ntl build/ntl-5xx/src directory, and then
gmake again...

\section{tryM2}
\begin{verbatim}
  git clone git@mithril.vbi.vt.edu:~/tryM2.git
\end{verbatim}

\end{document}
